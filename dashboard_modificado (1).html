<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Brasil - Dados em Tempo Real</title>
    
    <!-- Fontes do Google -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Chart.js para gr√°ficos -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    
    <!-- Leaflet para mapas interativos -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js" crossorigin=""></script>
    
    <style>
        :root {
            --bg-color: #0a0a1a;
            --card-bg: #141432;
            --text-color: #ffffff;
            --accent-color-1: #ff4d7c;
            --accent-color-2: #ff8a3d;
            --accent-color-3: #4dc9ff;
            --accent-color-4: #8a56ff;
            --grid-gap: 15px;
            --card-padding: 20px;
            --card-radius: 10px;
            --card-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
        }
        
        .dashboard-header {
            border-bottom: 2px solid var(--accent-color-1);
            padding-bottom: 15px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .dashboard-header h1 {
            font-size: 2.2rem;
            font-weight: 500;
        }
        
        .last-update {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            grid-auto-rows: minmax(200px, auto);
            gap: var(--grid-gap);
        }
        
        .card {
            background-color: var(--card-bg);
            border-radius: var(--card-radius);
            padding: var(--card-padding);
            box-shadow: var(--card-shadow);
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 25px rgba(0, 0, 0, 0.4);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 10px;
        }
        
        .card-title {
            font-size: 1.2rem;
            font-weight: 500;
            color: var(--text-color);
        }
        
        .card-icon {
            font-size: 1.5rem;
            opacity: 0.8;
        }
        
        .card-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        /* Tamanhos de cards espec√≠ficos */
        .card-total-vendas {
            grid-column: span 3;
            grid-row: span 1;
        }
        
        .card-clima {
            grid-column: span 3;
            grid-row: span 1;
        }
        
        .card-economia {
            grid-column: span 3;
            grid-row: span 1;
        }
        
        .card-demografia {
            grid-column: span 3;
            grid-row: span 1;
        }
        
        .card-linha-tempo {
            grid-column: span 6;
            grid-row: span 2;
        }
        
        .card-mapa {
            grid-column: span 6;
            grid-row: span 2;
        }
        
        .card-top-produtos {
            grid-column: span 3;
            grid-row: span 2;
        }
        
        .card-segmento {
            grid-column: span 3;
            grid-row: span 2;
        }
        
        .card-top-clientes {
            grid-column: span 3;
            grid-row: span 2;
        }
        
        .card-vendedores {
            grid-column: span 3;
            grid-row: span 2;
        }
        
        /* Cards demogr√°ficos compactos */
        .card-demografico-compacto {
            grid-column: span 3;
            grid-row: span 1;
            min-height: 150px;
        }
        
        /* Estilos para KPIs */
        .kpi-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin: 10px 0;
        }
        
        .kpi-label {
            font-size: 0.9rem;
            opacity: 0.7;
        }
        
        .kpi-change {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
            margin-top: 5px;
        }
        
        .kpi-change.positive {
            color: #4caf50;
        }
        
        .kpi-change.negative {
            color: #f44336;
        }
        
        /* Estilos para gr√°ficos */
        .chart-container {
            width: 100%;
            height: 100%;
            min-height: 200px;
            position: relative;
        }
        
        /* Estilos para o mapa */
        #map-brasil {
            width: 100%;
            height: 100%;
            min-height: 300px;
            border-radius: var(--card-radius);
        }
        
        /* Estilos para listas */
        .ranking-list {
            list-style: none;
            margin-top: 10px;
        }
        
        .ranking-item {
            display: flex;
            flex-direction: column;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .ranking-item:last-child {
            border-bottom: none;
        }
        
        .ranking-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }
        
        .ranking-label {
            font-size: 0.95rem;
            color: rgba(255, 255, 255, 0.9);
        }
        
        .ranking-value {
            font-weight: 500;
            text-align: right;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }
        
        .iqa-value {
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .iqa-class {
            font-size: 0.75rem;
            opacity: 0.7;
        }
        
        .iqa-legenda {
            font-size: 0.8rem;
            margin-top: 10px;
            text-align: center;
            opacity: 0.7;
        }
        
        .ranking-bar-container {
            width: 100%;
            height: 8px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .ranking-bar {
            height: 100%;
            width: 0; /* Come√ßa em 0 para anima√ß√£o */
            background: linear-gradient(to right, var(--accent-color-1), var(--accent-color-2));
            border-radius: 4px;
            transition: width 1s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .animate-bar {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.8; }
            100% { opacity: 1; }
        }
        
        /* Anima√ß√µes */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .card {
            animation: fadeIn 0.5s ease forwards;
        }
        
        /* Responsividade */
        @media (max-width: 1200px) {
            .dashboard-grid {
                grid-template-columns: repeat(6, 1fr);
            }
            
            .card-total-vendas, .card-clima, .card-economia, .card-demografia {
                grid-column: span 3;
            }
            
            .card-linha-tempo, .card-mapa {
                grid-column: span 6;
            }
            
            .card-top-produtos, .card-segmento, .card-top-clientes, .card-vendedores {
                grid-column: span 3;
            }
            
            .card-demografico-compacto {
                grid-column: span 3;
            }
        }
        
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .card-total-vendas, .card-clima, .card-economia, .card-demografia {
                grid-column: span 2;
            }
            
            .card-linha-tempo, .card-mapa {
                grid-column: span 2;
            }
            
            .card-top-produtos, .card-segmento, .card-top-clientes, .card-vendedores {
                grid-column: span 2;
            }
            
            .card-demografico-compacto {
                grid-column: span 2;
            }
        }
        
        @media (max-width: 480px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .card {
                grid-column: span 1;
            }
            
            .dashboard-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .dashboard-header h1 {
                margin-bottom: 10px;
            }
        }
        
        /* Loader para carregamento de dados */
        .loader {
            width: 30px;
            height: 30px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--accent-color-1);
            animation: spin 1s ease-in-out infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Estilos para card footer e fontes */
        .card-footer {
            margin-top: 10px;
            padding-top: 8px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            text-align: right;
        }
        
        .fonte-dados {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.5);
            font-style: italic;
        }
        
        /* Estilos para caixa de pesquisa do clima */
        .clima-search {
            display: flex;
            margin-top: 10px;
            padding: 0 10px;
        }
        
        .clima-search-input {
            flex: 1;
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px 0 0 20px;
            padding: 8px 15px;
            color: white;
            font-size: 0.9rem;
            outline: none;
            transition: all 0.3s ease;
        }
        
        .clima-search-input:focus {
            background-color: rgba(255, 255, 255, 0.15);
            border-color: var(--accent-color-3);
            box-shadow: 0 0 0 2px rgba(77, 201, 255, 0.3);
        }
        
        .clima-search-btn {
            background: linear-gradient(to right, var(--accent-color-3), var(--accent-color-4));
            border: none;
            border-radius: 0 20px 20px 0;
            padding: 8px 15px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .clima-search-btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        
        /* Tooltip personalizado */
        .tooltip {
            position: absolute;
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            pointer-events: none;
            z-index: 1000;
            font-size: 0.9rem;
            max-width: 200px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            opacity: 0;
            transition: opacity 0.3s;
        }
    </style>
</head>
<body>
    <div class="dashboard-header">
        <h1>Dashboard Brasil</h1>
        <div class="last-update">√öltima atualiza√ß√£o: <span id="update-time">Carregando...</span></div>
    </div>
    
    <div class="dashboard-grid">
        <!-- Card Clima -->
        <div class="card card-clima">
            <div class="card-header">
                <h2 class="card-title">Clima</h2>
                <div class="card-icon">üå§Ô∏è</div>
            </div>
            <div class="card-content" id="clima-content">
                <div class="loader" id="clima-loader"></div>
            </div>
            <div class="clima-search">
                <input type="text" id="cidade-input" placeholder="Pesquisar cidade..." class="clima-search-input">
                <button id="cidade-search-btn" class="clima-search-btn">
                    <span>üîç</span>
                </button>
            </div>
            <div class="card-footer">
                <small class="fonte-dados">Fonte: OpenWeatherMap</small>
            </div>
        </div>
        
        <!-- Card Economia - D√≥lar -->
        <div class="card card-economia">
            <div class="card-header">
                <h2 class="card-title">Cota√ß√£o do D√≥lar</h2>
                <div class="card-icon">üí±</div>
            </div>
            <div class="card-content" id="dolar-content">
                <div class="loader" id="dolar-loader"></div>
            </div>
            <div class="card-footer">
                <small class="fonte-dados">Fonte: AwesomeAPI</small>
            </div>
        </div>
        
        <!-- Card Economia - Indicadores -->
        <div class="card card-economia">
            <div class="card-header">
                <h2 class="card-title">Indicadores Econ√¥micos</h2>
                <div class="card-icon">üìä</div>
            </div>
            <div class="card-content" id="indicadores-content">
                <div class="loader" id="indicadores-loader"></div>
            </div>
            <div class="card-footer">
                <small class="fonte-dados">Fonte: Banco Central do Brasil</small>
            </div>
        </div>
        
        <!-- Card Demografia -->
        <div class="card card-demografia">
            <div class="card-header">
                <h2 class="card-title">Popula√ß√£o Brasil</h2>
                <div class="card-icon">üë•</div>
            </div>
            <div class="card-content" id="populacao-content">
                <div class="loader" id="populacao-loader"></div>
            </div>
            <div class="card-footer">
                <small class="fonte-dados">Fonte: IBGE</small>
            </div>
        </div>
        
        <!-- Card Linha do Tempo -->
        <div class="card card-linha-tempo">
            <div class="card-header">
                <h2 class="card-title">Evolu√ß√£o Econ√¥mica</h2>
                <div class="card-icon">üìà</div>
            </div>
            <div class="card-content">
                <div class="chart-container">
                    <canvas id="linha-tempo-chart"></canvas>
                </div>
            </div>
            <div class="card-footer">
                <small class="fonte-dados">Fonte: Banco Central do Brasil</small>
            </div>
        </div>
        
        <!-- Card Mapa Brasil -->
        <div class="card card-mapa">
            <div class="card-header">
                <h2 class="card-title">Mapa Ambiental Brasil</h2>
                <div class="card-icon">üó∫Ô∏è</div>
            </div>
            <div class="card-content">
                <div id="map-brasil"></div>
            </div>
            <div class="card-footer">
                <small class="fonte-dados">Fonte: INPE/TerraBrasilis</small>
            </div>
        </div>
        
        <!-- Card PIB por Setor -->
        <div class="card card-top-produtos">
            <div class="card-header">
                <h2 class="card-title">PIB por Setor</h2>
                <div class="card-icon">üè≠</div>
            </div>
            <div class="card-content">
                <div class="chart-container">
                    <canvas id="pib-setor-chart"></canvas>
                </div>
            </div>
            <div class="card-footer">
                <small class="fonte-dados">Fonte: IBGE</small>
            </div>
        </div>
        
        <!-- Card Emiss√£o de Gases -->
        <div class="card card-segmento">
            <div class="card-header">
                <h2 class="card-title">Emiss√£o de Gases</h2>
                <div class="card-icon">üè≠</div>
            </div>
            <div class="card-content">
                <div class="chart-container">
                    <canvas id="emissao-gases-chart"></canvas>
                </div>
            </div>
            <div class="card-footer">
                <small class="fonte-dados">Fonte: SEEG Brasil</small>
            </div>
        </div>
        
        <!-- Card Maiores Cidades -->
        <div class="card card-top-clientes">
            <div class="card-header">
                <h2 class="card-title">Maiores Cidades</h2>
                <div class="card-icon">üèôÔ∏è</div>
            </div>
            <div class="card-content" id="cidades-content">
                <div class="loader" id="cidades-loader"></div>
            </div>
            <div class="card-footer">
                <small class="fonte-dados">Fonte: IBGE</small>
            </div>
        </div>
        
        <!-- Card Qualidade do Ar -->
        <div class="card card-vendedores">
            <div class="card-header">
                <h2 class="card-title">Qualidade do Ar</h2>
                <div class="card-icon">üí®</div>
            </div>
            <div class="card-content" id="qualidade-ar-content">
                <div class="loader" id="qualidade-ar-loader"></div>
            </div>
            <div class="card-footer">
                <small class="fonte-dados">Fonte: IQAir</small>
            </div>
        </div>
        
        <!-- Card Taxa de Natalidade -->
        <div class="card card-demografico-compacto">
            <div class="card-header">
                <h2 class="card-title">Taxa de Natalidade</h2>
                <div class="card-icon">üë∂</div>
            </div>
            <div class="card-content" id="natalidade-content">
                <div class="loader" id="natalidade-loader"></div>
            </div>
            <div class="card-footer">
                <small class="fonte-dados">Fonte: IBGE</small>
            </div>
        </div>
        
        <!-- Card Taxa de Mortalidade -->
        <div class="card card-demografico-compacto">
            <div class="card-header">
                <h2 class="card-title">Taxa de Mortalidade</h2>
                <div class="card-icon">üìâ</div>
            </div>
            <div class="card-content" id="mortalidade-content">
                <div class="loader" id="mortalidade-loader"></div>
            </div>
            <div class="card-footer">
                <small class="fonte-dados">Fonte: IBGE</small>
            </div>
        </div>
        
        <!-- Card Expectativa de Vida -->
        <div class="card card-demografico-compacto">
            <div class="card-header">
                <h2 class="card-title">Expectativa de Vida</h2>
                <div class="card-icon">‚è≥</div>
            </div>
            <div class="card-content" id="expectativa-vida-content">
                <div class="loader" id="expectativa-vida-loader"></div>
            </div>
            <div class="card-footer">
                <small class="fonte-dados">Fonte: IBGE</small>
            </div>
        </div>
        
        <!-- Card Taxa de Desemprego -->
        <div class="card card-demografico-compacto">
            <div class="card-header">
                <h2 class="card-title">Taxa de Desemprego</h2>
                <div class="card-icon">üíº</div>
            </div>
            <div class="card-content" id="desemprego-content">
                <div class="loader" id="desemprego-loader"></div>
            </div>
            <div class="card-footer">
                <small class="fonte-dados">Fonte: IBGE</small>
            </div>
        </div>
    </div>
    
    <script>
        // Configura√ß√µes globais
        const weatherApiKey = "87b42475468c3ba9298cf245b2fa9379";
        const updateInterval = 10 * 60 * 1000; // 10 minutos em milissegundos
        let lastUpdateTime = new Date();
        
        // Cores para gr√°ficos
        const chartColors = [
            'rgba(255, 77, 124, 0.8)',
            'rgba(255, 138, 61, 0.8)',
            'rgba(77, 201, 255, 0.8)',
            'rgba(138, 86, 255, 0.8)',
            'rgba(255, 206, 86, 0.8)',
            'rgba(75, 192, 192, 0.8)',
            'rgba(153, 102, 255, 0.8)'
        ];
        
        // Fun√ß√£o para formatar n√∫meros
        function formatNumber(number, decimals = 0) {
            return number.toLocaleString('pt-BR', {
                minimumFractionDigits: decimals,
                maximumFractionDigits: decimals
            });
        }
        
        // Fun√ß√£o para formatar data
        function formatDate(date) {
            return date.toLocaleString('pt-BR', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }
        
        // Fun√ß√£o para atualizar o hor√°rio da √∫ltima atualiza√ß√£o
        function updateLastUpdateTime() {
            lastUpdateTime = new Date();
            document.getElementById('update-time').textContent = formatDate(lastUpdateTime);
        }
        
        // Fun√ß√£o para mostrar erro
        function showError(elementId, message) {
            const element = document.getElementById(elementId);
            element.innerHTML = `
                <div style="color: #f44336; text-align: center;">
                    <p>‚ö†Ô∏è ${message}</p>
                    <button onclick="fetchAllData()" style="margin-top: 10px; padding: 5px 10px; background: var(--accent-color-1); border: none; border-radius: 4px; color: white; cursor: pointer;">
                        Tentar novamente
                    </button>
                </div>
            `;
        }
        
        // Fun√ß√£o para buscar dados clim√°ticos
        async function fetchWeatherData(city = "S√£o Paulo") {
            try {
                document.getElementById('clima-loader').style.display = 'block';
                
                const response = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city},br&units=metric&lang=pt_br&appid=${weatherApiKey}`);
                
                if (!response.ok) {
                    throw new Error('Falha ao buscar dados clim√°ticos');
                }
                
                const data = await response.json();
                
                const climaContent = document.getElementById('clima-content');
                document.getElementById('clima-loader').style.display = 'none';
                
                climaContent.innerHTML = `
                    <div style="text-align: center;" class="clima-info">
                        <img src="https://openweathermap.org/img/wn/${data.weather[0].icon}@2x.png" alt="${data.weather[0].description}" style="width: 80px; height: 80px;" class="clima-icon">
                        <div class="kpi-value">${Math.round(data.main.temp)}¬∞C</div>
                        <div class="kpi-label">${data.weather[0].description}</div>
                        <div style="margin-top: 10px; display: flex; justify-content: space-around; text-align: center;">
                            <div>
                                <div style="font-size: 0.9rem; opacity: 0.7;">Umidade</div>
                                <div style="font-weight: 500;">${data.main.humidity}%</div>
                            </div>
                            <div>
                                <div style="font-size: 0.9rem; opacity: 0.7;">Vento</div>
                                <div style="font-weight: 500;">${Math.round(data.wind.speed * 3.6)} km/h</div>
                            </div>
                        </div>
                        <div style="font-size: 0.8rem; margin-top: 10px; opacity: 0.7;">${city}</div>
                    </div>
                `;
                
                // Adicionar anima√ß√£o
                const climaInfo = document.querySelector('.clima-info');
                climaInfo.style.opacity = '0';
                climaInfo.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    climaInfo.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                    climaInfo.style.opacity = '1';
                    climaInfo.style.transform = 'translateY(0)';
                }, 100);
                
                return true;
            } catch (error) {
                console.error('Erro ao buscar dados clim√°ticos:', error);
                showError('clima-content', 'N√£o foi poss√≠vel carregar os dados clim√°ticos');
                return false;
            }
        }
        
        // Fun√ß√£o para buscar cota√ß√£o do d√≥lar usando AwesomeAPI
        async function fetchDolarData() {
            try {
                document.getElementById('dolar-loader').style.display = 'block';
                
                // Usando a AwesomeAPI para cota√ß√£o do d√≥lar
                const response = await fetch('https://economia.awesomeapi.com.br/json/last/USD-BRL');
                
                if (!response.ok) {
                    throw new Error('Falha ao buscar cota√ß√£o do d√≥lar');
                }
                
                const data = await response.json();
                const dolarInfo = data.USDBRL;
                
                const dolarValue = parseFloat(dolarInfo.bid);
                const previousValue = parseFloat(dolarInfo.bid) - parseFloat(dolarInfo.varBid);
                const change = parseFloat(dolarInfo.varBid);
                const changePercent = parseFloat(dolarInfo.pctChange);
                const dataAtual = dolarInfo.create_date;
                
                const dolarContent = document.getElementById('dolar-content');
                document.getElementById('dolar-loader').style.display = 'none';
                
                dolarContent.innerHTML = `
                    <div style="text-align: center;">
                        <div class="kpi-value">R$ ${dolarValue.toFixed(2)}</div>
                        <div class="kpi-label">D√≥lar Comercial</div>
                        <div class="kpi-change ${change >= 0 ? 'positive' : 'negative'}">
                            ${change >= 0 ? '‚ñ≤' : '‚ñº'} ${Math.abs(change).toFixed(2)} (${Math.abs(changePercent).toFixed(2)}%)
                        </div>
                        <div style="font-size: 0.8rem; margin-top: 10px; opacity: 0.7;">Data: ${dataAtual}</div>
                    </div>
                `;
                
                return true;
            } catch (error) {
                console.error('Erro ao buscar cota√ß√£o do d√≥lar:', error);
                showError('dolar-content', 'N√£o foi poss√≠vel carregar a cota√ß√£o do d√≥lar');
                return false;
            }
        }
        
        // Fun√ß√£o para buscar indicadores econ√¥micos
        async function fetchIndicadoresEconomicos() {
            try {
                document.getElementById('indicadores-loader').style.display = 'block';
                
                // Buscar taxa Selic
                const selicResponse = await fetch('https://api.bcb.gov.br/dados/serie/bcdata.sgs.11/dados/ultimos/1?formato=json');
                
                if (!selicResponse.ok) {
                    throw new Error('Falha ao buscar taxa Selic');
                }
                
                const selicData = await selicResponse.json();
                const selicValue = parseFloat(selicData[0].valor);
                
                // Buscar IPCA
                const ipcaResponse = await fetch('https://api.bcb.gov.br/dados/serie/bcdata.sgs.433/dados/ultimos/1?formato=json');
                
                if (!ipcaResponse.ok) {
                    throw new Error('Falha ao buscar IPCA');
                }
                
                const ipcaData = await ipcaResponse.json();
                const ipcaValue = parseFloat(ipcaData[0].valor);
                
                const indicadoresContent = document.getElementById('indicadores-content');
                document.getElementById('indicadores-loader').style.display = 'none';
                
                indicadoresContent.innerHTML = `
                    <div style="display: flex; justify-content: space-around; text-align: center;">
                        <div>
                            <div class="kpi-value">${selicValue.toFixed(2)}%</div>
                            <div class="kpi-label">Taxa Selic</div>
                        </div>
                        <div>
                            <div class="kpi-value">${ipcaValue.toFixed(2)}%</div>
                            <div class="kpi-label">IPCA (mensal)</div>
                        </div>
                    </div>
                    <div style="font-size: 0.8rem; margin-top: 15px; text-align: center; opacity: 0.7;">Fonte: Banco Central do Brasil</div>
                `;
                
                return true;
            } catch (error) {
                console.error('Erro ao buscar indicadores econ√¥micos:', error);
                showError('indicadores-content', 'N√£o foi poss√≠vel carregar os indicadores econ√¥micos');
                return false;
            }
        }
        
        // Fun√ß√£o para buscar dados de popula√ß√£o
        async function fetchPopulacaoData() {
            try {
                document.getElementById('populacao-loader').style.display = 'block';
                
                // Usando dados simulados j√° que a API do IBGE pode ter restri√ß√µes de CORS
                const populacao = 215000000;
                const nascimentosHoje = 7850;
                const obitosHoje = 3420;
                
                const populacaoContent = document.getElementById('populacao-content');
                document.getElementById('populacao-loader').style.display = 'none';
                
                populacaoContent.innerHTML = `
                    <div style="text-align: center;">
                        <div class="kpi-value">${formatNumber(populacao)}</div>
                        <div class="kpi-label">Habitantes</div>
                        <div style="display: flex; justify-content: space-around; margin-top: 15px; text-align: center;">
                            <div>
                                <div style="font-size: 0.9rem; opacity: 0.7;">Nascimentos hoje</div>
                                <div style="font-weight: 500;">${formatNumber(nascimentosHoje)}</div>
                            </div>
                            <div>
                                <div style="font-size: 0.9rem; opacity: 0.7;">√ìbitos hoje</div>
                                <div style="font-weight: 500;">${formatNumber(obitosHoje)}</div>
                            </div>
                        </div>
                    </div>
                `;
                
                return true;
            } catch (error) {
                console.error('Erro ao buscar dados de popula√ß√£o:', error);
                showError('populacao-content', 'N√£o foi poss√≠vel carregar os dados de popula√ß√£o');
                return false;
            }
        }
        
        // Fun√ß√£o para buscar dados de cidades
        async function fetchCidadesData() {
            try {
                document.getElementById('cidades-loader').style.display = 'block';
                
                const response = await fetch('https://servicodados.ibge.gov.br/api/v1/localidades/municipios?orderBy=popula√ß√£o');
                
                if (!response.ok) {
                    throw new Error('Falha ao buscar dados de cidades');
                }
                
                // Como a API n√£o retorna a popula√ß√£o, vamos usar dados fict√≠cios para as maiores cidades
                const topCidades = [
                    { nome: 'S√£o Paulo', populacao: 12396372 },
                    { nome: 'Rio de Janeiro', populacao: 6775561 },
                    { nome: 'Bras√≠lia', populacao: 3094325 },
                    { nome: 'Salvador', populacao: 2900319 },
                    { nome: 'Fortaleza', populacao: 2703391 }
                ];
                
                const cidadesContent = document.getElementById('cidades-content');
                document.getElementById('cidades-loader').style.display = 'none';
                
                let cidadesHTML = '<ul class="ranking-list">';
                
                topCidades.forEach((cidade, index) => {
                    const percentWidth = 100 - (index * 15); // Diminui a largura progressivamente
                    
                    cidadesHTML += `
                        <li class="ranking-item">
                            <div class="ranking-info">
                                <div class="ranking-label">${cidade.nome}</div>
                                <div class="ranking-value">${formatNumber(cidade.populacao)}</div>
                            </div>
                            <div class="ranking-bar-container">
                                <div class="ranking-bar" style="width: ${percentWidth}%;" data-value="${cidade.populacao}"></div>
                            </div>
                        </li>
                    `;
                });
                
                cidadesHTML += '</ul>';
                cidadesContent.innerHTML = cidadesHTML;
                
                // Adicionar anima√ß√£o para as barras
                setTimeout(() => {
                    document.querySelectorAll('.ranking-bar').forEach(bar => {
                        bar.classList.add('animate-bar');
                    });
                }, 300);
                
                return true;
            } catch (error) {
                console.error('Erro ao buscar dados de cidades:', error);
                showError('cidades-content', 'N√£o foi poss√≠vel carregar os dados de cidades');
                return false;
            }
        }
        
        // Fun√ß√£o para buscar dados de qualidade do ar (dados reais da API IQair)
        async function fetchQualidadeArData() {
            try {
                document.getElementById('qualidade-ar-loader').style.display = 'block';
                
                // Chave da API IQair fornecida pelo usu√°rio
                const iqairApiKey = "3f1fb754-4625-466d-9ed7-1f6901b8dc93";
                
                // Lista de cidades brasileiras para buscar dados
                const cidades = [
                    { nome: "S√£o Paulo", lat: -23.5505, lon: -46.6333 },
                    { nome: "Rio de Janeiro", lat: -22.9068, lon: -43.1729 },
                    { nome: "Bras√≠lia", lat: -15.7801, lon: -47.9292 },
                    { nome: "Curitiba", lat: -25.4284, lon: -49.2733 },
                    { nome: "Manaus", lat: -3.1190, lon: -60.0217 }
                ];
                
                // Array para armazenar os dados de qualidade do ar
                const qualidadeArData = [];
                
                // Buscar dados para cada cidade
                for (const cidade of cidades) {
                    try {
                        const response = await fetch(`https://api.airvisual.com/v2/nearest_city?lat=${cidade.lat}&lon=${cidade.lon}&key=${iqairApiKey}`);
                        
                        if (!response.ok) {
                            throw new Error(`Falha ao buscar dados para ${cidade.nome}`);
                        }
                        
                        const data = await response.json();
                        
                        if (data.status === "success" && data.data && data.data.current && data.data.current.pollution) {
                            const aqius = data.data.current.pollution.aqius; // √çndice de qualidade do ar (padr√£o EUA)
                            
                            // Determinar classifica√ß√£o com base no √≠ndice AQI dos EUA
                            let classificacao = '';
                            if (aqius <= 50) classificacao = 'Boa';
                            else if (aqius <= 100) classificacao = 'Moderada';
                            else if (aqius <= 150) classificacao = 'Inadequada';
                            else if (aqius <= 200) classificacao = 'Ruim';
                            else if (aqius <= 300) classificacao = 'Muito Ruim';
                            else classificacao = 'Perigosa';
                            
                            qualidadeArData.push({
                                cidade: cidade.nome,
                                indice: aqius,
                                classificacao: classificacao
                            });
                        }
                    } catch (cityError) {
                        console.error(`Erro ao buscar dados para ${cidade.nome}:`, cityError);
                        // Continuar com as pr√≥ximas cidades mesmo se uma falhar
                    }
                }
                
                // Se n√£o conseguiu dados para nenhuma cidade, tenta buscar apenas a cidade mais pr√≥xima
                if (qualidadeArData.length === 0) {
                    try {
                        const response = await fetch(`https://api.airvisual.com/v2/nearest_city?key=${iqairApiKey}`);
                        
                        if (!response.ok) {
                            throw new Error('Falha ao buscar dados da cidade mais pr√≥xima');
                        }
                        
                        const data = await response.json();
                        
                        if (data.status === "success" && data.data && data.data.current && data.data.current.pollution) {
                            const aqius = data.data.current.pollution.aqius;
                            const cidade = data.data.city || 'Cidade mais pr√≥xima';
                            
                            let classificacao = '';
                            if (aqius <= 50) classificacao = 'Boa';
                            else if (aqius <= 100) classificacao = 'Moderada';
                            else if (aqius <= 150) classificacao = 'Inadequada';
                            else if (aqius <= 200) classificacao = 'Ruim';
                            else if (aqius <= 300) classificacao = 'Muito Ruim';
                            else classificacao = 'Perigosa';
                            
                            qualidadeArData.push({
                                cidade: cidade,
                                indice: aqius,
                                classificacao: classificacao
                            });
                        }
                    } catch (nearestCityError) {
                        console.error('Erro ao buscar dados da cidade mais pr√≥xima:', nearestCityError);
                    }
                }
                
                // Se ainda n√£o tiver dados, usar dados de fallback
                if (qualidadeArData.length === 0) {
                    qualidadeArData.push(
                        { cidade: 'S√£o Paulo', indice: 65, classificacao: 'Moderada' },
                        { cidade: 'Rio de Janeiro', indice: 45, classificacao: 'Boa' },
                        { cidade: 'Bras√≠lia', indice: 35, classificacao: 'Boa' },
                        { cidade: 'Curitiba', indice: 30, classificacao: 'Boa' },
                        { cidade: 'Manaus', indice: 75, classificacao: 'Inadequada' }
                    );
                    console.warn('Usando dados de fallback para qualidade do ar');
                }
                
                const qualidadeArContent = document.getElementById('qualidade-ar-content');
                document.getElementById('qualidade-ar-loader').style.display = 'none';
                
                let qualidadeArHTML = '<ul class="ranking-list">';
                
                qualidadeArData.forEach(item => {
                    let colorClass;
                    if (item.indice <= 50) colorClass = 'background: linear-gradient(to right, #4caf50, #8bc34a)';
                    else if (item.indice <= 100) colorClass = 'background: linear-gradient(to right, #ffc107, #ff9800)';
                    else if (item.indice <= 150) colorClass = 'background: linear-gradient(to right, #f44336, #e91e63)';
                    else if (item.indice <= 200) colorClass = 'background: linear-gradient(to right, #d32f2f, #b71c1c)';
                    else if (item.indice <= 300) colorClass = 'background: linear-gradient(to right, #7b1fa2, #4a148c)';
                    else colorClass = 'background: linear-gradient(to right, #880e4f, #4a0025)';
                    
                    qualidadeArHTML += `
                        <li class="ranking-item">
                            <div class="ranking-info">
                                <div class="ranking-label">${item.cidade}</div>
                                <div class="ranking-value">
                                    <span class="iqa-value">${item.indice}</span>
                                    <span class="iqa-class">${item.classificacao}</span>
                                </div>
                            </div>
                            <div class="ranking-bar-container">
                                <div class="ranking-bar" style="${colorClass}" data-value="${Math.min(item.indice, 100)}"></div>
                            </div>
                        </li>
                    `;
                });
                
                qualidadeArHTML += '</ul>';
                qualidadeArHTML += '<div class="iqa-legenda">√çndice de Qualidade do Ar (IQA) - Dados em tempo real</div>';
                
                qualidadeArContent.innerHTML = qualidadeArHTML;
                
                // Adicionar anima√ß√£o para as barras
                setTimeout(() => {
                    const bars = document.querySelectorAll('#qualidade-ar-content .ranking-bar');
                    bars.forEach(bar => {
                        const value = bar.getAttribute('data-value');
                        bar.style.width = value + '%';
                        bar.classList.add('animate-bar');
                    });
                }, 300);
                
                return true;
            } catch (error) {
                console.error('Erro ao buscar dados de qualidade do ar:', error);
                showError('qualidade-ar-content', 'N√£o foi poss√≠vel carregar os dados de qualidade do ar');
                return false;
            }
        }
        
        // Fun√ß√£o para mostrar dados de taxa de natalidade
        function showNatalidadeData() {
            try {
                document.getElementById('natalidade-loader').style.display = 'block';
                
                // Dados de taxa de natalidade (por 1.000 habitantes)
                const taxaNatalidade = 14.2;
                const dataReferencia = "2023";
                
                const natalidadeContent = document.getElementById('natalidade-content');
                document.getElementById('natalidade-loader').style.display = 'none';
                
                natalidadeContent.innerHTML = `
                    <div style="text-align: center;">
                        <div class="kpi-value">${taxaNatalidade.toFixed(1)}</div>
                        <div class="kpi-label">por 1.000 habitantes</div>
                        <div style="font-size: 0.8rem; margin-top: 10px; opacity: 0.7;">Refer√™ncia: ${dataReferencia}</div>
                    </div>
                `;
                
                return true;
            } catch (error) {
                console.error('Erro ao mostrar dados de natalidade:', error);
                showError('natalidade-content', 'N√£o foi poss√≠vel carregar os dados de natalidade');
                return false;
            }
        }
        
        // Fun√ß√£o para mostrar dados de taxa de mortalidade
        function showMortalidadeData() {
            try {
                document.getElementById('mortalidade-loader').style.display = 'block';
                
                // Dados de taxa de mortalidade (por 1.000 habitantes)
                const taxaMortalidade = 6.7;
                const dataReferencia = "2023";
                
                const mortalidadeContent = document.getElementById('mortalidade-content');
                document.getElementById('mortalidade-loader').style.display = 'none';
                
                mortalidadeContent.innerHTML = `
                    <div style="text-align: center;">
                        <div class="kpi-value">${taxaMortalidade.toFixed(1)}</div>
                        <div class="kpi-label">por 1.000 habitantes</div>
                        <div style="font-size: 0.8rem; margin-top: 10px; opacity: 0.7;">Refer√™ncia: ${dataReferencia}</div>
                    </div>
                `;
                
                return true;
            } catch (error) {
                console.error('Erro ao mostrar dados de mortalidade:', error);
                showError('mortalidade-content', 'N√£o foi poss√≠vel carregar os dados de mortalidade');
                return false;
            }
        }
        
        // Fun√ß√£o para mostrar dados de expectativa de vida
        function showExpectativaVidaData() {
            try {
                document.getElementById('expectativa-vida-loader').style.display = 'block';
                
                // Dados de expectativa de vida (em anos)
                const expectativaVida = 76.8;
                const dataReferencia = "2023";
                
                const expectativaVidaContent = document.getElementById('expectativa-vida-content');
                document.getElementById('expectativa-vida-loader').style.display = 'none';
                
                expectativaVidaContent.innerHTML = `
                    <div style="text-align: center;">
                        <div class="kpi-value">${expectativaVida.toFixed(1)}</div>
                        <div class="kpi-label">anos</div>
                        <div style="font-size: 0.8rem; margin-top: 10px; opacity: 0.7;">Refer√™ncia: ${dataReferencia}</div>
                    </div>
                `;
                
                return true;
            } catch (error) {
                console.error('Erro ao mostrar dados de expectativa de vida:', error);
                showError('expectativa-vida-content', 'N√£o foi poss√≠vel carregar os dados de expectativa de vida');
                return false;
            }
        }
        
        // Fun√ß√£o para mostrar dados de taxa de desemprego
        function showDesempregoData() {
            try {
                document.getElementById('desemprego-loader').style.display = 'block';
                
                // Dados de taxa de desemprego (em %)
                const taxaDesemprego = 7.9;
                const dataReferencia = "2023";
                
                const desempregoContent = document.getElementById('desemprego-content');
                document.getElementById('desemprego-loader').style.display = 'none';
                
                desempregoContent.innerHTML = `
                    <div style="text-align: center;">
                        <div class="kpi-value">${taxaDesemprego.toFixed(1)}%</div>
                        <div class="kpi-label">da popula√ß√£o ativa</div>
                        <div style="font-size: 0.8rem; margin-top: 10px; opacity: 0.7;">Refer√™ncia: ${dataReferencia}</div>
                    </div>
                `;
                
                return true;
            } catch (error) {
                console.error('Erro ao mostrar dados de desemprego:', error);
                showError('desemprego-content', 'N√£o foi poss√≠vel carregar os dados de desemprego');
                return false;
            }
        }
        
        // Fun√ß√£o para criar gr√°fico de linha do tempo
        function createLinhaTempoChart() {
            const ctx = document.getElementById('linha-tempo-chart').getContext('2d');
            
            // Dados simulados para PIB e Infla√ß√£o
            const anos = ['2015', '2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024'];
            const pibData = [-3.5, -3.3, 1.3, 1.8, 1.4, -4.1, 4.8, 3.0, 2.9, 3.2];
            const inflacaoData = [10.7, 6.3, 2.9, 3.7, 4.3, 4.5, 10.1, 5.8, 4.6, 4.1];
            
            const linhaTempoChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: anos,
                    datasets: [
                        {
                            label: 'PIB (%)',
                            data: pibData,
                            borderColor: chartColors[2],
                            backgroundColor: 'rgba(77, 201, 255, 0.1)',
                            borderWidth: 3,
                            pointRadius: 4,
                            pointBackgroundColor: chartColors[2],
                            tension: 0.3,
                            fill: false
                        },
                        {
                            label: 'Infla√ß√£o (%)',
                            data: inflacaoData,
                            borderColor: chartColors[0],
                            backgroundColor: 'rgba(255, 77, 124, 0.1)',
                            borderWidth: 3,
                            pointRadius: 4,
                            pointBackgroundColor: chartColors[0],
                            tension: 0.3,
                            fill: false
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'rgba(0, 0, 0, 0.7)',
                            titleColor: 'rgba(255, 255, 255, 0.9)',
                            bodyColor: 'rgba(255, 255, 255, 0.9)',
                            borderColor: 'rgba(255, 255, 255, 0.2)',
                            borderWidth: 1,
                            padding: 10,
                            displayColors: true,
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.raw + '%';
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            }
                        },
                        y: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Fun√ß√£o para criar gr√°fico de PIB por setor
        function createPIBSetorChart() {
            const ctx = document.getElementById('pib-setor-chart').getContext('2d');
            
            // Dados simulados para PIB por setor
            const setores = ['Servi√ßos', 'Ind√∫stria', 'Agropecu√°ria', 'Impostos'];
            const pibSetorData = [60, 20, 10, 10];
            
            const pibSetorChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: setores,
                    datasets: [{
                        data: pibSetorData,
                        backgroundColor: chartColors,
                        borderColor: 'rgba(0, 0, 0, 0.1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                font: {
                                    size: 12
                                },
                                padding: 15
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.7)',
                            titleColor: 'rgba(255, 255, 255, 0.9)',
                            bodyColor: 'rgba(255, 255, 255, 0.9)',
                            borderColor: 'rgba(255, 255, 255, 0.2)',
                            borderWidth: 1,
                            padding: 10,
                            displayColors: true,
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.raw + '%';
                                }
                            }
                        }
                    },
                    cutout: '60%',
                    animation: {
                        animateScale: true,
                        animateRotate: true
                    }
                }
            });
        }
        
        // Fun√ß√£o para criar gr√°fico de emiss√£o de gases
        function createEmissaoGasesChart() {
            const ctx = document.getElementById('emissao-gases-chart').getContext('2d');
            
            // Dados simulados para emiss√£o de gases por setor
            const setores = ['Energia', 'Agropecu√°ria', 'Ind√∫stria', 'Res√≠duos', 'Outros'];
            const emissaoData = [30, 25, 20, 15, 10];
            
            const emissaoGasesChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: setores,
                    datasets: [{
                        data: emissaoData,
                        backgroundColor: chartColors,
                        borderColor: 'rgba(0, 0, 0, 0.1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                font: {
                                    size: 12
                                },
                                padding: 15
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.7)',
                            titleColor: 'rgba(255, 255, 255, 0.9)',
                            bodyColor: 'rgba(255, 255, 255, 0.9)',
                            borderColor: 'rgba(255, 255, 255, 0.2)',
                            borderWidth: 1,
                            padding: 10,
                            displayColors: true,
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.raw + '%';
                                }
                            }
                        }
                    },
                    animation: {
                        animateScale: true,
                        animateRotate: true
                    }
                }
            });
        }
        
        // Fun√ß√£o para inicializar o mapa
        function initMap() {
            const map = L.map('map-brasil').setView([-15.7801, -47.9292], 4);
            
            // Adicionar camada de mapa base
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                maxZoom: 18
            }).addTo(map);
            
            // Adicionar marcadores para as principais cidades
            const cidades = [
                { nome: "S√£o Paulo", lat: -23.5505, lon: -46.6333, pop: "12.3M" },
                { nome: "Rio de Janeiro", lat: -22.9068, lon: -43.1729, pop: "6.7M" },
                { nome: "Bras√≠lia", lat: -15.7801, lon: -47.9292, pop: "3.1M" },
                { nome: "Salvador", lat: -12.9714, lon: -38.5014, pop: "2.9M" },
                { nome: "Fortaleza", lat: -3.7319, lon: -38.5267, pop: "2.7M" },
                { nome: "Belo Horizonte", lat: -19.9167, lon: -43.9345, pop: "2.5M" },
                { nome: "Manaus", lat: -3.1190, lon: -60.0217, pop: "2.2M" },
                { nome: "Curitiba", lat: -25.4284, lon: -49.2733, pop: "1.9M" },
                { nome: "Recife", lat: -8.0476, lon: -34.8770, pop: "1.6M" },
                { nome: "Porto Alegre", lat: -30.0346, lon: -51.2177, pop: "1.4M" }
            ];
            
            cidades.forEach(cidade => {
                L.marker([cidade.lat, cidade.lon])
                    .addTo(map)
                    .bindPopup(`<b>${cidade.nome}</b><br>Popula√ß√£o: ${cidade.pop}`);
            });
            
            // Adicionar √°reas de desmatamento (simulado)
            const desmatamentoAreas = [
                { lat: -3.4653, lon: -62.2159, radius: 50000, name: "√Årea de Desmatamento 1" },
                { lat: -7.1314, lon: -55.4925, radius: 70000, name: "√Årea de Desmatamento 2" },
                { lat: -9.9442, lon: -67.8076, radius: 40000, name: "√Årea de Desmatamento 3" }
            ];
            
            desmatamentoAreas.forEach(area => {
                L.circle([area.lat, area.lon], {
                    color: 'red',
                    fillColor: '#f03',
                    fillOpacity: 0.3,
                    radius: area.radius
                }).addTo(map).bindPopup(area.name);
            });
            
            // Adicionar √°reas de preserva√ß√£o (simulado)
            const preservacaoAreas = [
                { lat: -2.4206, lon: -54.7412, radius: 80000, name: "√Årea de Preserva√ß√£o 1" },
                { lat: -13.2687, lon: -52.1945, radius: 60000, name: "√Årea de Preserva√ß√£o 2" },
                { lat: -5.2744, lon: -49.1192, radius: 50000, name: "√Årea de Preserva√ß√£o 3" }
            ];
            
            preservacaoAreas.forEach(area => {
                L.circle([area.lat, area.lon], {
                    color: 'green',
                    fillColor: '#0f3',
                    fillOpacity: 0.3,
                    radius: area.radius
                }).addTo(map).bindPopup(area.name);
            });
        }
        
        // Fun√ß√£o para buscar todos os dados
        async function fetchAllData() {
            // Iniciar carregamento de dados
            updateLastUpdateTime();
            
            // Buscar dados em paralelo
            const promises = [
                fetchWeatherData(),
                fetchDolarData(),
                fetchIndicadoresEconomicos(),
                fetchPopulacaoData(),
                fetchCidadesData(),
                fetchQualidadeArData()
            ];
            
            // Mostrar dados demogr√°ficos
            showNatalidadeData();
            showMortalidadeData();
            showExpectativaVidaData();
            showDesempregoData();
            
            // Criar gr√°ficos
            createLinhaTempoChart();
            createPIBSetorChart();
            createEmissaoGasesChart();
            
            // Inicializar mapa
            initMap();
            
            // Aguardar todas as requisi√ß√µes
            await Promise.all(promises);
        }
        
        // Inicializar dashboard
        document.addEventListener('DOMContentLoaded', () => {
            fetchAllData();
            
            // Configurar pesquisa de cidade para clima
            document.getElementById('cidade-search-btn').addEventListener('click', () => {
                const cidade = document.getElementById('cidade-input').value.trim();
                if (cidade) {
                    fetchWeatherData(cidade);
                }
            });
            
            document.getElementById('cidade-input').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    const cidade = document.getElementById('cidade-input').value.trim();
                    if (cidade) {
                        fetchWeatherData(cidade);
                    }
                }
            });
            
            // Atualizar dados periodicamente
            setInterval(fetchAllData, updateInterval);
        });
    </script>
</body>
</html>
